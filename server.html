<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<meta http-equiv="Cache-Control" content="No-Cache">

	<title></title>
	<style>

@import "css/itahm.css";

body {
	position: fixed; top: 0; right: 0; bottom: 0; left: 0;
	margin: 0; padding: 0;
	display: flex; flex-direction: column;
	background-color: #4d525a;
}

header {
	flex: none;
	padding: 20px;
}

article {
	flex: 1;
	display: flex;
}

section {
	flex: 1;
	display: flex; flex-direction: column;
}

iframe {
	flex: 1;
	border: none;
	width: 100%; height: 100%;
	margin: 0; padding: 0;
}

table {
	width: 100%;
	font-size: 20px;
	color: #fff;
	border-collapse: collapse;
}

thead {
	border-bottom: 1px solid #fff;
}

td, th {
	padding: 0.5em;
}

td {
	text-align: center;
}

td:last-child {
	text-align: center;
}

	</style>
	<script>

function initialize() {try{
	var entry, index, resource;
	
	document.title = (function (sysName) {
		return window.ip + (sysName? (" ["+ sysName +"]"): "");
	})(window.snmp.sysName);
	
	document.getElementById("ip").textContent = window.ip;
	document.getElementById("name").textContent = window.device.name;
	document.getElementById("type").textContent = window.device.type;
	document.getElementById("label").textContent = window.device.label;
	
	loadFrame(document.getElementById("response"), "chart_responseTime.html");
	
	entry = window.snmp.hrProcessorEntry;
	
	for (index in entry) {
		loadFrame(window.lSection.appendChild(document.createElement("iframe")),"chart_processor.html"); 
		
		break;
	}
	
	entry = window.snmp.hrStorageEntry;
	
	for (index in entry) {
		resource = entry[index];
		
		switch(resource.hrStorageType) {
		case 4:
			if (resource.hrStorageSize > 0) {
				loadFrame(window.rSection.appendChild(document.createElement("iframe"))
					, "chart_storage.html?"+ index);
			}
			
			break;
		case 2:
			loadFrame(window.lSection.appendChild(document.createElement("iframe"))
					, "chart_memory.html?"+ index);
			
			break;
		}
	}
	
	document.body.classList.remove("loading");}catch(e) {console.log(e);}
}

function loadFrame(iframe, src) {
	iframe.onload = onLoadFrame;
	iframe.src = src;
}

function onLoadFrame() {
	this.contentWindow.initialize(window.start, window.end, window.start, window.end);
}

	</script>
</head>
<body class="loading">
	<header>
		<table>
			<thead>
				<tr>
					<th>IP</th>
					<th>이름</th>
					<th>종류</th>
					<th>구분</th>
					<th>기간</th>
				</tr>
			</thead>
			<tbody>
				<tr>
					<td id="ip"></td>
					<td id="name"></td>
					<td id="type"></td>
					<td id="label"></td>
					<td id="period">
						<input type="date">
						<input type="date">
					</td>
				</tr>
			</tbody>
		</table>
	</header>
	<article>
		<section id="left"></section>
		<section id="right">
			<iframe id="response"></iframe>
		</section>
	</article>
	
	<div class="bg_loading"></div>
	<script>
var origin = "server",
	sendRequest = opener.top.sendRequest,
	databases = opener.top.databases,
	ip = window.location.search.substring(1),
	device = opener.top.databases.device[ip],
	lSection = document.getElementById("left"),
	rSection = document.getElementById("right"),
	start, end;

(function (date) {
	date.setHours(0, 0, 0, 0);
	
	window.start = date.setDate(date.getDate() -6);
	window.end = date.setDate(date.getDate() +7);
})(new Date());

sendRequest({
	command: "select",
	ip: window.ip	
}, function (snmp) {
	window.snmp = snmp;
	
	initialize();
});

	</script>
</body>
</html>