<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<meta http-equiv="Content-Script-Type" content="text/javascript">
		<meta http-equiv="Content-Style-Type" content="text/css">
		<title>Event @ ITAhM</title>
		
		<style>
@import "css/itahm.css";
@import "css/calendar.css";

body {
	position: fixed; top: 0; right: 0; bottom: 0; left: 0;
}

.content_width {
	height: 100%;
	padding: 10px;
	margin: 0 auto;
	display: flex;
	flex-direction: column;
}

header {
	display: flex;
	justify-content: space-between;
}

iframe {
	flex: 1;
	width: 100%; height: 100%;
	border: none;
}


#calendar {
	border: 1px solid #0084ff;
	padding: 5px;
}

		</style>
		
	</head>
	
	<body>
	
		<div class="content_width">
			
			<header>
				<div>
					<h1>이벤트 로그</h1>
					<h2 id="date">Date</h2>
					<label>
						<input type="radio" name="setting" id="log" value="log" checked>보기
					</label>
					<label>
						<input type="radio" name="setting" id="critical" value="critical">설정
					</label>
				</div>
				<div id="calendar"></div>
			</header>
			
			<iframe></iframe>
			
		</div>
		
		<div class="bg_loading"></div>
		
		<script src="js/ITAhM.js"></script>
		<script src="js/object.js"></script>
		<script>
if (top === window) {
	location.href = "http://itahm.com";
}

var iFrame = document.querySelector("iframe"),
	date = document.getElementById("date");

document.getElementById("log").onchange = onSelectMode;
document.getElementById("critical").onchange = onSelectMode;

top.clearLog();

onSelectMode.call({value: "log"});

function onSelectMode() {
	switch(this.value) {
	case "log":
		iFrame.onload = onLoadLog.bind(iFrame, new Date().setHours(0, 0, 0, 0));
		iFrame.src = "log.html";
		
		break;
		
	case "critical":
		iFrame.onload = onLoadCritical;
		iFrame.src = "critical.html";
		
		break;
	}
}

new ITAhM.Calendar("calendar", function (date) {
	document.getElementById("log").checked = true;
	
	iFrame.onload = onLoadLog.bind(iFrame, date.getTime());
	iFrame.src = "log.html";
});

function onLoadLog(mills) {
	this.contentWindow.initialize(mills);
	
	date.textContent = getDateString(mills);
}

function onLoadCritical() {
	
}

function getDateString(mills) {
	var date = new Date(mills),
		yyyy = date.getFullYear(),
		mm = date.getMonth() +1,
		dd = date.getDate();
	
	return yyyy +"-"+ (mm > 9? "": "0") + mm +"-"+ (dd > 9? "": "0") + dd;
}

		</script>
	
	</body>
	
</html>